<!DOCTYPE html>
{% load static %}
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SXD Tube</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
</head>
<body>
<!-- Navbar -->
<nav class="navbar">
    <!-- Logo qismi -->
    <div class="logo">
        <img src="https://t4.ftcdn.net/jpg/04/67/15/09/360_F_467150902_zUs6Dvp9wJLGOoQRMOqGBtXaqXAJOFTO.jpg"
             alt="SXD Logo">
        <span>SXD Tube</span>
    </div>

    <!-- Home bo'limi -->
    <div class="home">
        <a href="{% url 'index' %}">Home</a>
    </div>

    <!-- Menu bo'limi -->
    <div class="menu">
        <ul>
            <li><a href="{% url 'multfilimlar' %}">Multfilm</a></li>
            <li><a href="#">Anime</a></li>
            <li><a href="{% url 'kinolar' %}">Kinolar</a></li>
            <li><a href="{% url 'seriallar' %}">Seriallar</a></li>
        </ul>
    </div>

    <!-- Qidiruv oynasi -->
    <div class="search-call">
        <input type="text" placeholder="Qidirish...">
        <button class="call-icon">üîé</button>
    </div>

    <!-- Foydalanuvchi menyusi -->
    <div class="user-interface">
        <img class="image"
             src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSgqugyJge8XSwS5JVVpb1_BxA-w2Ue8H8Kiw&s"
             alt="User Icon">

        {% if user.is_authenticated %}
        <button class="user-btn" onclick="toggleDropdown()">{{ user.username }}</button>
        <div class="dropdown">
            <a href="#">Profil</a>
            <!-- Logout uchun forma -->
            <form method="post" action="{% url 'logout' %}">
                {% csrf_token %}
                <button type="submit" class="logout-btn">Logout</button>
            </form>
            <a href="#">{{ user.email }}</a>
        </div>
        {% else %}
        <a href="{% url 'login' %}" class="user-btn">Login</a>
        <a href="{% url 'signup' %}" class="user-btn">Register</a>
        {% endif %}
    </div>
</nav>

<!-- Video bo'limi -->
<div class="container-video-katta">
    <video id="intro-video" class="responsive-video" autoplay muted loop>
        <source src="{{ select_movies.video_fayl.url }}" type="video/mp4">
        Sizning brauzeringiz videoni qo‚Äòllab-quvvatlamaydi.
    </video>

    <!-- Video haqida ma'lumot -->
    <div class="video-info">
        <div class="video-title">
            <h3>{{ select_movies.name }}</h3>
            <p class="reyting">
                {% for i in ratings %}
                {% if forloop.counter <= select_movies.reyting %}
                <i class="fa-solid fa-star" style="color: red;"></i>
                {% else %}
                <i class="fa-regular fa-star" style="color: gray;"></i>
                {% endif %}
                {% endfor %}
            </p>
            <p class="sight-age">Ko'rish yoshi: {{ select_movies.sight_age }}+</p>
        </div>
    </div>
</div>

<!-- Play Now tugmasi -->
<div class="play-now-button-container">
    <button id="play-now-btn" class="play-now-button" onclick="playNow()">Play Now</button>
</div>

<!-- Sound tugmasi -->
<div style="position: absolute; top: 90%; z-index: 10; left: 80%;">
    <button id="sound-btn" class="sound-button" onclick="toggleSound()">üîá</button>
</div>

<!-- Video Modal -->
<div id="video-modal" class="video-modal">
    <button class="close-modal" onclick="closeModal()">&times;</button>
    <video id="modal-video" controls>
        <source src="{{ select_movies.video_fayl.url }}" type="video/mp4">
        Sizning brauzeringiz videoni qo‚Äòllab-quvvatlamaydi.
    </video>

    <!-- Video boshqaruv tugmalari -->
    <div class="video-controls">
        <button onclick="rewindVideo()">‚è™ Orqaga</button>
        <button onclick="togglePlayPause()">‚èØÔ∏è Pause/Play</button>
        <button onclick="forwardVideo()">‚è© Oldinga</button>
    </div>
</div>

{% block content %}
{% endblock %}

<!-- JavaScript kodlari -->
<script>
    function toggleDropdown() {
        var dropdown = document.querySelector('.dropdown');
        dropdown.classList.toggle('active');
    }

    function openModal() {
        const modal = document.getElementById('video-modal');
        const video = document.getElementById('modal-video');
        modal.style.display = 'flex';
        video.play();
    }

    function closeModal() {
        const modal = document.getElementById('video-modal');
        const video = document.getElementById('modal-video');
        video.pause();
        modal.style.display = 'none';
    }

    function togglePlayPause() {
        const video = document.getElementById('modal-video');
        video.paused ? video.play() : video.pause();
    }

    function rewindVideo() {
        const video = document.getElementById('modal-video');
        video.currentTime -= 10;
    }

    function forwardVideo() {
        const video = document.getElementById('modal-video');
        video.currentTime += 10;
    }

    function toggleSound() {
        const video = document.getElementById('intro-video');
        const soundBtn = document.getElementById('sound-btn');
        video.muted = !video.muted;
        soundBtn.textContent = video.muted ? 'üîá' : 'üîä';
    }

    function playNow() {
        openModal();
    }
</script>
<script src="{% static 'js/script.js' %}"></script>
</body>
</html>
